import * as tsplus_module_1 from "@effect/data/Option";
import * as tsplus_module_2 from "@effect/io/Ref";
import * as tsplus_module_3 from "@effect/io/Effect";
import * as SendEvents from "./sendEvents.js";
import * as OS from "os";
const identify = ({ token, intents, shard, presence }) => SendEvents.identify({
    token,
    intents,
    properties: {
        os: OS.platform(),
        browser: "dfx",
        device: "dfx",
    },
    shard,
    presence,
});
const resume = (token, ready, seq) => SendEvents.resume({
    token,
    session_id: ready.session_id,
    seq,
});
export const identifyOrResume = (opts, ready, seq) => tsplus_module_3.flatMap(tsplus_module_2.get(ready), readyEvent => tsplus_module_3.map(tsplus_module_2.get(seq), seqNumber => tsplus_module_1.match(tsplus_module_1.struct({
    readyEvent,
    seqNumber,
}), () => identify(opts), ({ readyEvent, seqNumber }) => resume(opts.token, readyEvent, seqNumber))));
//# sourceMappingURL=identify.js.map