import * as tsplus_module_1 from "@effect/stream/Stream";
import * as tsplus_module_2 from "@effect/io/Effect";
import * as tsplus_module_3 from "@effect/data/Option";
import * as tsplus_module_4 from "@effect/io/Ref";
import * as tsplus_module_5 from "@effect/data/Function";
export const opCode = (source) => (code) => tsplus_module_1.filter(source, (p) => p.op === code);
const maybeUpdateRef = (f, ref) => tsplus_module_5.flow(f, o => tsplus_module_3.match(o, tsplus_module_2.unit, a => tsplus_module_4.set(ref, tsplus_module_3.some(a))));
export const latest = (f) => tsplus_module_2.map(tsplus_module_4.make(tsplus_module_3.none()), ref => [ref, maybeUpdateRef(f, ref)]);
//# sourceMappingURL=utils.js.map